(.venv) bijut@b:~/aws_apps/fred_fintech_app$ python3 -m src.model.trigger_training
sagemaker.config INFO - Not applying SDK defaults from location: /etc/xdg/sagemaker/config.yaml
sagemaker.config INFO - Not applying SDK defaults from location: /home/bijut/.config/sagemaker/config.yaml
üöÄ Starting Training Job...
INFO:sagemaker:Creating training-job with name: sagemaker-xgboost-2026-01-10-07-19-42-785
2026-01-10 07:19:44 Starting - Starting the training job...
2026-01-10 07:19:58 Starting - Preparing the instances for training...
2026-01-10 07:20:24 Downloading - Downloading input data...
2026-01-10 07:21:09 Downloading - Downloading the training image......
2026-01-10 07:22:25 Training - Training image download completed. Training in progress.
2026-01-10 07:22:25 Uploading - Uploading generated training model/miniconda3/lib/python3.8/site-packages/xgboost/compat.py:36: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.
  from pandas import MultiIndex, Int64Index
[2026-01-10 07:22:12.215 ip-10-0-219-170.ec2.internal:8 INFO utils.py:28] RULE_JOB_STOP_SIGNAL_FILENAME: None
[2026-01-10 07:22:12.239 ip-10-0-219-170.ec2.internal:8 INFO profiler_config_parser.py:111] User has disabled profiler.
[2026-01-10:07:22:12:INFO] Imported framework sagemaker_xgboost_container.training
[2026-01-10:07:22:12:INFO] No GPUs detected (normal if no gpus installed)
[2026-01-10:07:22:12:INFO] Invoking user training script.
[2026-01-10:07:22:12:INFO] Module train_entrypoint does not provide a setup.py.
Generating setup.py
[2026-01-10:07:22:12:INFO] Generating setup.cfg
[2026-01-10:07:22:12:INFO] Generating MANIFEST.in
[2026-01-10:07:22:12:INFO] Installing module with the following command:
/miniconda3/bin/python3 -m pip install .
Processing /opt/ml/code
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Building wheels for collected packages: train-entrypoint
  Building wheel for train-entrypoint (setup.py): started
  Building wheel for train-entrypoint (setup.py): finished with status 'done'
  Created wheel for train-entrypoint: filename=train_entrypoint-1.0.0-py2.py3-none-any.whl size=12314 sha256=9d387fe22676e75653aee84d005a44b4771d3b9ca26007b59d40680975d92b5e
  Stored in directory: /home/model-server/tmp/pip-ephem-wheel-cache-khk6a33k/wheels/f3/75/57/158162e9eab7af12b5c338c279b3a81f103b89d74eeb911c00
Successfully built train-entrypoint
Installing collected packages: train-entrypoint
Successfully installed train-entrypoint-1.0.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv      
[2026-01-10:07:22:14:INFO] No GPUs detected (normal if no gpus installed)
[2026-01-10:07:22:14:INFO] Invoking user script
Training Env:
{
    "additional_framework_parameters": {},
    "channel_input_dirs": {
        "train": "/opt/ml/input/data/train"
    },
    "current_host": "algo-1",
    "framework_module": "sagemaker_xgboost_container.training:main",
    "hosts": [
        "algo-1"
    ],
    "hyperparameters": {
        "eta": "0.2",
        "max_depth": "5",
        "objective": "reg:squarederror"
    },
    "input_config_dir": "/opt/ml/input/config",
    "input_data_config": {
        "train": {
            "ContentType": "csv",
            "TrainingInputMode": "File",
            "S3DistributionType": "FullyReplicated",
            "RecordWrapperType": "None"
        }
    },
    "input_dir": "/opt/ml/input",
    "is_master": true,
    "job_name": "sagemaker-xgboost-2026-01-10-07-19-42-785",
    "log_level": 20,
    "master_hostname": "algo-1",
    "model_dir": "/opt/ml/model",
    "module_dir": "s3://fred-fintech-data-637423309379/sagemaker-xgboost-2026-01-10-07-19-42-785/source/sourcedir.tar.gz",
    "module_name": "train_entrypoint",
    "network_interface_name": "eth0",
    "num_cpus": 2,
    "num_gpus": 0,
    "output_data_dir": "/opt/ml/output/data",
    "output_dir": "/opt/ml/output",
    "output_intermediate_dir": "/opt/ml/output/intermediate",
    "resource_config": {
        "current_host": "algo-1",
        "current_instance_type": "ml.m5.large",
        "current_group_name": "homogeneousCluster",
        "hosts": [
            "algo-1"
        ],
        "instance_groups": [
            {
                "instance_group_name": "homogeneousCluster",
                "instance_type": "ml.m5.large",
                "hosts": [
                    "algo-1"
                ]
            }
        ],
        "network_interface_name": "eth0",
        "topology": null
    },
    "user_entry_point": "train_entrypoint.py"
}
Environment variables:
SM_HOSTS=["algo-1"]
SM_NETWORK_INTERFACE_NAME=eth0
SM_HPS={"eta":"0.2","max_depth":"5","objective":"reg:squarederror"}
SM_USER_ENTRY_POINT=train_entrypoint.py
SM_FRAMEWORK_PARAMS={}
SM_RESOURCE_CONFIG={"current_group_name":"homogeneousCluster","current_host":"algo-1","current_instance_type":"ml.m5.large","hosts":["algo-1"],"instance_groups":[{"hosts":["algo-1"],"instance_group_name":"homogeneousCluster","instance_type":"ml.m5.large"}],"network_interface_name":"eth0","topology":null}
SM_INPUT_DATA_CONFIG={"train":{"ContentType":"csv","RecordWrapperType":"None","S3DistributionType":"FullyReplicated","TrainingInputMode":"File"}}
SM_OUTPUT_DATA_DIR=/opt/ml/output/data
SM_CHANNELS=["train"]
SM_CURRENT_HOST=algo-1
SM_MODULE_NAME=train_entrypoint
SM_LOG_LEVEL=20
SM_FRAMEWORK_MODULE=sagemaker_xgboost_container.training:main
SM_INPUT_DIR=/opt/ml/input
SM_INPUT_CONFIG_DIR=/opt/ml/input/config
SM_OUTPUT_DIR=/opt/ml/output
SM_NUM_CPUS=2
SM_NUM_GPUS=0
SM_MODEL_DIR=/opt/ml/model
SM_MODULE_DIR=s3://fred-fintech-data-637423309379/sagemaker-xgboost-2026-01-10-07-19-42-785/source/sourcedir.tar.gz
SM_TRAINING_ENV={"additional_framework_parameters":{},"channel_input_dirs":{"train":"/opt/ml/input/data/train"},"current_host":"algo-1","framework_module":"sagemaker_xgboost_container.training:main","hosts":["algo-1"],"hyperpar
ameters":{"eta":"0.2","max_depth":"5","objective":"reg:squarederror"},"input_config_dir":"/opt/ml/input/config","input_data_config":{"train":{"ContentType":"csv","RecordWrapperType":"None","S3DistributionType":"FullyReplicated"
,"TrainingInputMode":"File"}},"input_dir":"/opt/ml/input","is_master":true,"job_name":"sagemaker-xgboost-2026-01-10-07-19-42-785","log_level":20,"master_hostname":"algo-1","model_dir":"/opt/ml/model","module_dir":"s3://fred-fin
tech-data-637423309379/sagemaker-xgboost-2026-01-10-07-19-42-785/source/sourcedir.tar.gz","module_name":"train_entrypoint","network_interface_name":"eth0","num_cpus":2,"num_gpus":0,"output_data_dir":"/opt/ml/output/data","outpu
t_dir":"/opt/ml/output","output_intermediate_dir":"/opt/ml/output/intermediate","resource_config":{"current_group_name":"homogeneousCluster","current_host":"algo-1","current_instance_type":"ml.m5.large","hosts":["algo-1"],"instance_groups":[{"hosts":["algo-1"],"instance_group_name":"homogeneousCluster","instance_type":"ml.m5.large"}],"network_interface_name":"eth0","topology":null},"user_entry_point":"train_entrypoint.py"}
SM_USER_ARGS=["--eta","0.2","--max_depth","5","--objective","reg:squarederror"]
SM_OUTPUT_INTERMEDIATE_DIR=/opt/ml/output/intermediate
SM_CHANNEL_TRAIN=/opt/ml/input/data/train
SM_HP_ETA=0.2
SM_HP_MAX_DEPTH=5
SM_HP_OBJECTIVE=reg:squarederror
PYTHONPATH=/miniconda3/bin:/:/miniconda3/lib/python/site-packages/xgboost/dmlc-core/tracker:/miniconda3/lib/python38.zip:/miniconda3/lib/python3.8:/miniconda3/lib/python3.8/lib-dynload:/miniconda3/lib/python3.8/site-packages   
Invoking script with the following command:
/miniconda3/bin/python3 -m train_entrypoint --eta 0.2 --max_depth 5 --objective reg:squarederror
/miniconda3/lib/python3.8/site-packages/xgboost/compat.py:36: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.
  from pandas import MultiIndex, Int64Index
üöÄ Starting Training Script...
Reading data from: /opt/ml/input/data/train/train.csv
Data shape: (6866, 5)
/miniconda3/lib/python3.8/site-packages/xgboost/data.py:262: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.
  elif isinstance(data.columns, (pd.Int64Index, pd.RangeIndex)):
/miniconda3/lib/python3.8/site-packages/xgboost/data.py:262: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.
  elif isinstance(data.columns, (pd.Int64Index, pd.RangeIndex)):
‚è≥ Training XGBoost model...
[0]#011train-rmse:4.40125#011validation-rmse:4.39854
[1]#011train-rmse:3.52666#011validation-rmse:3.52324
[2]#011train-rmse:2.82620#011validation-rmse:2.82150
[3]#011train-rmse:2.26585#011validation-rmse:2.25770
[4]#011train-rmse:1.81743#011validation-rmse:1.80772
[5]#011train-rmse:1.45883#011validation-rmse:1.44678
[6]#011train-rmse:1.17219#011validation-rmse:1.15813
[7]#011train-rmse:0.94334#011validation-rmse:0.92752
[8]#011train-rmse:0.76093#011validation-rmse:0.74262
[9]#011train-rmse:0.61605#011validation-rmse:0.59456
[10]#011train-rmse:0.50135#011validation-rmse:0.47658
[11]#011train-rmse:0.41109#011validation-rmse:0.38288
[12]#011train-rmse:0.34083#011validation-rmse:0.30824
[13]#011train-rmse:0.28674#011validation-rmse:0.24920
[14]#011train-rmse:0.24468#011validation-rmse:0.20228
[15]#011train-rmse:0.21361#011validation-rmse:0.16747
[16]#011train-rmse:0.19006#011validation-rmse:0.13974
[17]#011train-rmse:0.17333#011validation-rmse:0.12131
[18]#011train-rmse:0.15643#011validation-rmse:0.11027
[19]#011train-rmse:0.14389#011validation-rmse:0.10580
[20]#011train-rmse:0.13547#011validation-rmse:0.10422
[21]#011train-rmse:0.12848#011validation-rmse:0.10694
[22]#011train-rmse:0.12343#011validation-rmse:0.11115
[23]#011train-rmse:0.11974#011validation-rmse:0.11590
[24]#011train-rmse:0.11695#011validation-rmse:0.12071
[25]#011train-rmse:0.11539#011validation-rmse:0.12397
[26]#011train-rmse:0.11468#011validation-rmse:0.12434
[27]#011train-rmse:0.11372#011validation-rmse:0.12756
[28]#011train-rmse:0.11301#011validation-rmse:0.13014
[29]#011train-rmse:0.11253#011validation-rmse:0.13266
‚úÖ Model saved to /opt/ml/model/xgboost-model

2026-01-10 07:22:39 Completed - Training job completed
Training seconds: 135
Billable seconds: 135
üìù Registering Model...
INFO:sagemaker.image_uris:Ignoring unnecessary instance type: ml.t2.medium.
‚úÖ Model Registered: arn:aws:sagemaker:us-east-1:637423309379:model-package/FredRecessionModels/2
(.venv) bijut@b:~/aws_apps/fred_fintech_app$ 

